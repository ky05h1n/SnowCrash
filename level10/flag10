level10:
- Found: /home/user/level10/level10 (SUID root binary)
- Behavior: Takes two arguments (file and host), sends file contents to host:6969
- Inside: Calls access(file), then connect(host, 6969), then open(file) and send
- Vulnerability: Classic TOCTOU (Time of Check to Time of Use)
- access(file) and open(file) are separate → symlink swap possible in between

Exploit Plan:
- Create /tmp/dummy file with dummy content
- Symlink /tmp/link → /tmp/dummy
- Launch TCP listener on port 6969
- Fork child to run: ./level10 /tmp/link 127.0.0.1
- Swap /tmp/link to → /home/user/level10/token
- Resume recv(), victim reads and sends real token

Exploit Result:
- Received: woupa2yuojeeaaed06riuj63c

Key Concepts:
- access() only checks path, doesn’t lock it
- open() follows symlink at time-of-use
- TCP socket write() blocks until peer reads → stall point!
- Resume recv(), victim reads and sends real token

FLag Token : feulo4b72j7edeahuete3no7c > level11




strace -f -e access,connect,write,open,read 
